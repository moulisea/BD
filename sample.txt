CREATE WRITABLE EXTERNAL TABLE bulkload.extr_iods_clients_hierarchy ( LIKE cib_raw.iods_cc_emu ) LOCATION (
'gpfdist://bdtcstr39n13.svr.us.jpmchase.net:8081/./RDT/iods_cc_emu.txt'
)FORMAT 'TEXT' (DELIMITER E'\x01' escape 'OFF') ENCODING 'UTF-8';

insert into bulkload.extr_iods_clients_hierarchy select * from cib_raw.iods_cc_emu;

drop external table bulkload.extr_iods_clients_hierarchy;

--------------------============================================================
create EXTERNAL TABLE bulkload.extr_iods_clients_hierarchy_r1 ( like institute_db_wholesale.iods_cc_emu) LOCATION (
'gpfdist://bdtcstr39n13.svr.us.jpmchase.net:8081/./RDT/iods_cc_emu.txt'
) FORMAT 'text' (delimiter E'\x01'  escape 'OFF') ENCODING 'UTF-8';

insert into institute_db_wholesale.iods_cc_emu select * from bulkload.extr_iods_clients_hierarchy_r1;

drop external table if exists bulkload.extr_iods_clients_hierarchy_r1;

--------------------============================================================

skew
SELECT gp_segment_id, count(*) FROM <TABLE_NAME> GROUP BY gp_segment_id
order by gp_segment_id desc 

----

-- Table: bulkload.morningstar_mutualfund_raw

-- DROP TABLE bulkload.morningstar_mutualfund_raw;

CREATE TABLE bulkload.morningstar_mutualfund_raw
(
ms_id text,
ms_InvestmentVehicleName text,
ms_InceptionDate date,
ms_Currency text,
ms_FundShareClassNetAssets double precision,
ms_FundShareClassNetAssetsEndDate date,
ms_FundNetAssets double precision,
ms_DomicileCountry text,
ms_MorningstarCategory_Name text,
ms_MorningstarCategory_Id text,
ms_MorningstarCategoryUSAssetClass_Name text,
ms_MorningstarCategoryUSAssetClass_Id text,
ms_GlobalCategoryAssetClass_Name text,
ms_GlobalCategoryAssetClass_Id text,
ms_GlobalCategoryName text,
ms_GlobalCategoryId text,
ms_ProviderCompany text,
ms_BrandingName text,
ms_FundFamilyName text,
ms_EnhancedIndexFund text,
ms_IndexFund text,
ms_PreviousName text,
ms_PreviousNameEndDate date,
ms_SurveyedFundNetAssets text,
ms_SurveyedFundNetAssetsEndDate date,
ms_FundLegalName text,
ms_MorningstarPureCategory_Name text,
ms_MorningstarPureCategory_Id text,
ms_FirmNetAssets text,
ms_FirmNetAssetsDate date,
ms_Legal_Name text,
ms_CUSIP text,
ms_ISIN text,
ms_SEDOL_Id text,
ms_Trading_Symbol text,
ms_folder_type text,
create_custom_date date,
create_custom_timestamp timestamp without time zone

)
WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column, COMPRESSTYPE=zlib, 
  OIDS=FALSE
)
DISTRIBUTED  BY(ms_id)
PARTITION BY RANGE(create_custom_date)
(PARTITION p201702 START ('2017-02-01') END('2017-02-28') INCLUSIVE WITH (orientation=column, appendonly=true))
;
ALTER TABLE bulkload.morningstar_mutualfund_raw OWNER TO v679520;
GRANT ALL ON TABLE bulkload.morningstar_mutualfund_raw TO v679520;
GRANT SELECT ON TABLE bulkload.morningstar_mutualfund_raw TO cib_ro_r;
GRANT SELECT ON TABLE bulkload.morningstar_mutualfund_raw TO cib_ro_dev_r;
GRANT SELECT ON TABLE bulkload.morningstar_mutualfund_raw TO globalid_read_only;
-----------------
