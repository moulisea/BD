package com.jpmis.hbase;

import java.io.IOException;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Connection;
import org.apache.hadoop.hbase.client.ConnectionFactory;
import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.util.Bytes;
import org.apache.hadoop.hbase.client.Table;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.ResultScanner;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.security.UserGroupInformation;

public class XmlParse 
{
    public static void main( String[] args )
    {     
        try{
        	Configuration config = HBaseConfiguration.create();
        	
			org.apache.hadoop.conf.Configuration conf = new     org.apache.hadoop.conf.Configuration();
        	conf.set("hadoop.security.authentication", "Kerberos");
            UserGroupInformation.setConfiguration(conf);            
            UserGroupInformation.loginUserFromKeytab("a_opsdata_nd@NAEAST.AD.JPMORGANCHASE.COM", "/home/a_opsdata_nd/a_opsdata_nd.keytab");
            
        	config.set("hbase.zookeeper.quorum","bdtcstr55n1.svr.us.jpmchase.net,bdtcstr55n10.svr.us.jpmchase.net,bdtcstr24n3.svr.us.jpmchase.net");
        	config.set("hbase.zookeeper.property.clientPort","2181");
        	
			Connection connection = ConnectionFactory.createConnection(config);
        	Table table = connection.getTable(TableName.valueOf("ns_intellistor:emp"));        	
        	Scan scan1 = new Scan();
        	ResultScanner scanner1 = table.getScanner(scan1);
        	for(Result res=scanner1.next();res!=null;res=scanner1.next()) {
        		System.out.println(res);        		
        	}        	
        }
         //catch (ParserConfigurationException | SAXException | IOException e){
    		catch (IOException e){
        	e.printStackTrace();
        }
    }
}
Put p = new Put(Bytes.toBytes("r1"));
p.add(Bytes.toBytes("personal"),Bytes.toBytes("city"),Bytes.toBytes("delhi"));
table.put(p);
